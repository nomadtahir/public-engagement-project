% Name           : beamerthememx.sty
% Author         : Miguel Xochicale (miguel.xochicale@klc.ac.uk)
% Author         : Séverin Lemaignan (severin.lemaignan@epfl.ch)
% License        : This file may be distributed and/or modified under the
%                  GNU Public License.

\ProvidesPackage{beamerthememx}[2021/05/14]

\usepackage{fontawesome}
\usepackage{multimedia}

\usepackage[scale=2]{ccicons}
\usepackage{qrcode}
\usepackage{tikz}
\usepackage{tikzpagenodes}
\usetikzlibrary{positioning}


% table related packages
\usepackage{array}

%---------------------------------------------------------------------
% custom commands
%---------------------------------------------------------------------
\newcommand{\githubrepository}[1]{»#1«}


% Titlepage structure
\def\maketitle{\ifbeamer@inframe\titlepage\else{\setbeamertemplate{background}{}\frame[plain]{\titlepage}}\fi}
\def\titlepage{
\usebeamertemplate{title page}
}



\setbeamertemplate{title page}{%

    \begin{minipage}[b][\paperheight]{\textwidth}
%    % Add background to title page
%    \AddToShipoutPictureFG*{\includegraphics[width=\paperwidth]{background.pdf}}
%    \begin{minipage}[b][\paperheight]{\textwidth}
    \vspace*{10mm}
%    \includegraphics[height=14mm]{logo}\par
%    \vspace*{5mm}
    \ifx\insertsubtitle\@empty%
    \else%
        {\usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle\par}%
    \fi%
    \ifx\insertsubtitle\@empty%
    \else%
        {\usebeamerfont{subtitle}\usebeamercolor[fg]{subtitle}\insertsubtitle\par}%
        \vspace*{5mm}
    \fi%
    \ifx\insertdate\@empty%
    \else%
        {\usebeamerfont{date}\usebeamercolor[fg]{date}\insertdate\par}%
    \fi%
%
    \vfill
        \vspace*{30mm}

    \ifx\insertauthor\@empty%
    \else%
        {\usebeamerfont{author}\usebeamercolor[fg]{author}\insertauthor\par}%
    \fi%
    \ifx\insertinstitut\@empty%
    \else%
        \vspace*{3mm}
        {\usebeamerfont{institute}\usebeamercolor[fg]{institute}\insertinstitute\par}%
    \fi%

    \vspace*{10mm}
    \end{minipage}


    \begin{tikzpicture}[overlay, remember picture]
    \node[%
      above right=0.35cm and -0.2cm of current page footer area.south west,
      anchor=south west,
      inner sep=-10pt] {%
%      \usebeamerfont{footline}
    \fontsize{4pt}{7.2}\selectfont
      \begin{tabular}{lm{.8\textwidth}}
        \href{http://creativecommons.org/licenses/by/4.0/}{\ccby} &
        This slices is licensed under a
	\href{http://creativecommons.org/licenses/by/4.0/}
		{Creative Commons ``Attribution 4.0 International''} license.
	\par Get source of this slides and see further references
		from \url{https://github.com/ofetus/us-simulator}
      \end{tabular}
    };
    \node[%
      above left=0.35cm and 0cm of current page footer area.south east,
      anchor=south east,
      inner sep=0pt]{\qrcode[height=1.5cm]{https://github.com/ofetus/us-simulator}};
    \end{tikzpicture}

}


%---------------------------------------------------------------------
% Footline
%---------------------------------------------------------------------
\usenavigationsymbolstemplate{} % hides small icons in bottom right corner use to navigate the presentation
\setbeamertemplate{footline}
{%
\begin{beamercolorbox}[wd=\textwidth,ht=3ex,dp=1.5ex,leftskip=0.3cm,rightskip=0.3cm]{structure}%
\usebeamerfont{page number in head/foot}%
\hfill\insertframenumber%
\end{beamercolorbox}%
}


%---------------------------------------------------------------------
% Add Paper using {\paper{}. begin{beawer} ... end{beamer} }
%---------------------------------------------------------------------
\newcommand\paper[1]{
	\setbeamertemplate{footline}
	{
		\begin{beamercolorbox}[wd=\textwidth,ht=3mm,dp=03mm,leftskip=0.3cm,rightskip=0.3cm]{black}%
        		\usebeamerfont{page number in head/foot}
			[#1]\mbox{}\hfill\insertframenumber
		\end{beamercolorbox}%
	}
}